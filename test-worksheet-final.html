<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ±Ùƒ Ø´ÙŠØª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
            text-align: right;
            background: #f5f5f5;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .data-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .test-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .test-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .test-details {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 11px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .progress {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: #007bff;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØ±Ùƒ Ø´ÙŠØª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h1>
        
        <div id="status" class="status info">
            ğŸ”„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±...
        </div>
        
        <div>
            <button class="btn" onclick="testAllConnections()" id="testBtn">Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª</button>
            <button class="btn" onclick="testSpecificData()" id="dataBtn">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</button>
            <button class="btn" onclick="simulateHourlyUpdate()" id="updateBtn">Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
            <button class="btn" onclick="showSystemInfo()" id="infoBtn">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</button>
        </div>
        
        <div id="progress-container" style="display: none;">
            <div class="progress">
                <div class="progress-bar" id="progress-bar">0%</div>
            </div>
        </div>
        
        <div id="results"></div>
    </div>

    <script>
        console.log('ğŸš€ Starting final worksheet integration test...');
        
        // Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù„Ù„ÙˆØ±Ùƒ Ø´ÙŠØª
        const WORKSHEET_URLS = {
            subscribersCSV: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pub?output=csv&gid=0',
            portfolioCSV: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pub?output=csv&gid=1',
            subscribersHTML: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pubhtml?gid=0&single=true',
            portfolioHTML: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pubhtml?gid=1&single=true',
            subscribersTSV: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pub?output=tsv&gid=0',
            portfolioTSV: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSIcY_pndHy91i5AE9asBpmtD0DP_msWb2vT8rs2rFFGiBLVy8mILf9Ac_rGKlizFYhdXOQIheHi5lx/pub?output=tsv&gid=1'
        };
        
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }
        
        function showResults(content) {
            document.getElementById('results').innerHTML = content;
        }
        
        function updateProgress(percent, text = '') {
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            
            if (percent > 0) {
                progressContainer.style.display = 'block';
                progressBar.style.width = percent + '%';
                progressBar.textContent = text || percent + '%';
            } else {
                progressContainer.style.display = 'none';
            }
        }
        
        function disableButtons(disabled = true) {
            const buttons = ['testBtn', 'dataBtn', 'updateBtn', 'infoBtn'];
            buttons.forEach(id => {
                document.getElementById(id).disabled = disabled;
            });
        }
        
        async function testSingleURL(name, url, expectedData) {
            console.log(`Testing ${name}: ${url}`);
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout
                
                const response = await fetch(url, { 
                    signal: controller.signal,
                    headers: {
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                });
                clearTimeout(timeoutId);
                
                const text = await response.text();
                
                // Check for specific data indicators
                const hasSubscriberData = text.includes('Ø¬Ø¹ÙØ±') && text.includes('534000223');
                const hasPortfolioData = text.includes('SPUS') || text.includes('S&P500') || text.includes('ÙŠØºØ·ÙŠ Ø§Ù„Ø£Ø³Ù‡Ù…');
                const isHTML = text.includes('<html') || text.includes('<table');
                const isCSV = text.includes(',') && !isHTML;
                const isTSV = text.includes('\t') && !isHTML;
                
                let dataQuality = 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                let hasExpectedData = false;
                
                if (expectedData === 'subscribers') {
                    hasExpectedData = hasSubscriberData;
                    if (hasSubscriberData) {
                        const lines = text.split('\n').filter(l => l.trim());
                        dataQuality = `${lines.length - 1} Ù…Ø´ØªØ±Ùƒ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹`;
                    }
                } else if (expectedData === 'portfolio') {
                    hasExpectedData = hasPortfolioData;
                    if (hasPortfolioData) {
                        const lines = text.split('\n').filter(l => l.trim());
                        dataQuality = `${lines.length - 1} Ø´Ø±ÙƒØ© ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹`;
                    }
                }
                
                return {
                    name: name,
                    url: url,
                    status: response.ok ? 'Ù†Ø¬Ø­' : 'ÙØ´Ù„',
                    responseTime: 'Ø£Ù‚Ù„ Ù…Ù† 30 Ø«Ø§Ù†ÙŠØ©',
                    dataLength: text.length,
                    hasExpectedData: hasExpectedData,
                    dataQuality: dataQuality,
                    format: isHTML ? 'HTML' : (isCSV ? 'CSV' : (isTSV ? 'TSV' : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ')),
                    preview: text.substring(0, 300),
                    error: null
                };
                
            } catch (error) {
                return {
                    name: name,
                    url: url,
                    status: 'Ø®Ø·Ø£',
                    error: error.message,
                    hasExpectedData: false
                };
            }
        }
        
        async function testAllConnections() {
            updateStatus('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª... (Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø¹Ø¯Ø© Ø¯Ù‚Ø§Ø¦Ù‚)', 'info');
            disableButtons(true);
            
            const tests = [
                { name: 'Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† (CSV)', url: WORKSHEET_URLS.subscribersCSV, expected: 'subscribers' },
                { name: 'Ø§Ù„Ù…Ø­ÙØ¸Ø© (CSV)', url: WORKSHEET_URLS.portfolioCSV, expected: 'portfolio' },
                { name: 'Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† (HTML)', url: WORKSHEET_URLS.subscribersHTML, expected: 'subscribers' },
                { name: 'Ø§Ù„Ù…Ø­ÙØ¸Ø© (HTML)', url: WORKSHEET_URLS.portfolioHTML, expected: 'portfolio' },
                { name: 'Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† (TSV)', url: WORKSHEET_URLS.subscribersTSV, expected: 'subscribers' },
                { name: 'Ø§Ù„Ù…Ø­ÙØ¸Ø© (TSV)', url: WORKSHEET_URLS.portfolioTSV, expected: 'portfolio' }
            ];
            
            const results = [];
            
            for (let i = 0; i < tests.length; i++) {
                const test = tests[i];
                const progress = Math.round(((i + 1) / tests.length) * 100);
                
                updateProgress(progress, `Ø§Ø®ØªØ¨Ø§Ø± ${test.name}...`);
                updateStatus(`ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± ${test.name}... (${i + 1}/${tests.length})`, 'info');
                
                const result = await testSingleURL(test.name, test.url, test.expected);
                results.push(result);
                
                // Small delay between requests
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            updateProgress(0);
            displayTestResults(results);
            
            const successfulTests = results.filter(r => r.status === 'Ù†Ø¬Ø­' && r.hasExpectedData);
            if (successfulTests.length > 0) {
                updateStatus(`âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${successfulTests.length} Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­ Ù…Ù† Ø£ØµÙ„ ${results.length}!`, 'success');
            } else {
                updateStatus('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø©ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'warning');
            }
            
            disableButtons(false);
        }
        
        function displayTestResults(results) {
            let html = '<div class="data-section"><h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª:</h3>';
            
            results.forEach(result => {
                const statusClass = result.status === 'Ù†Ø¬Ø­' && result.hasExpectedData ? 'status-success' : 
                                  result.status === 'Ù†Ø¬Ø­' ? 'status-warning' : 'status-error';
                const statusText = result.status === 'Ù†Ø¬Ø­' && result.hasExpectedData ? 'Ù…Ù…ØªØ§Ø²' :
                                 result.status === 'Ù†Ø¬Ø­' ? 'Ù…ØªØµÙ„ Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª' : 'ÙØ´Ù„';
                
                html += `
                    <div class="test-item">
                        <div class="test-name">
                            ${result.name}
                            <span class="status-badge ${statusClass}">${statusText}</span>
                        </div>
                        <div class="test-details">
                            <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${result.status}<br>
                            ${result.responseTime ? `<strong>ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:</strong> ${result.responseTime}<br>` : ''}
                            <strong>Ø·ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> ${result.dataLength || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'} Ø­Ø±Ù<br>
                            ${result.format ? `<strong>Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> ${result.format}<br>` : ''}
                            ${result.dataQuality ? `<strong>Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> ${result.dataQuality}<br>` : ''}
                            <strong>ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</strong> ${result.hasExpectedData ? 'Ù†Ø¹Ù… âœ…' : 'Ù„Ø§ âŒ'}<br>
                            ${result.error ? `<strong>Ø§Ù„Ø®Ø·Ø£:</strong> ${result.error}<br>` : ''}
                            ${result.preview ? `<strong>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong><pre>${result.preview}</pre>` : ''}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            showResults(html);
        }
        
        async function testSpecificData() {
            updateStatus('ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©...', 'info');
            disableButtons(true);
            
            // Test for specific known data
            const specificTests = [
                {
                    name: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¹ÙØ± Ø·Ø§Ù‡Ø± Ø§Ù„Ø²Ø¨Ø±',
                    url: WORKSHEET_URLS.subscribersCSV,
                    check: (text) => text.includes('Ø¬Ø¹ÙØ±') && text.includes('534000223') && text.includes('42')
                },
                {
                    name: 'Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø§Ø³ ØµØ§Ù„Ø­ Ø§Ù„Ø²Ø¨Ø±',
                    url: WORKSHEET_URLS.subscribersCSV,
                    check: (text) => text.includes('Ø¹Ø¨Ø§Ø³') && text.includes('504996691') && text.includes('24')
                },
                {
                    name: 'Ø´Ø±ÙƒØ© SPUS',
                    url: WORKSHEET_URLS.portfolioCSV,
                    check: (text) => text.includes('SPUS') && text.includes('257')
                },
                {
                    name: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­ÙØ¸Ø© 185,466.35',
                    url: WORKSHEET_URLS.portfolioCSV,
                    check: (text) => text.includes('185') && text.includes('466')
                }
            ];
            
            const results = [];
            
            for (const test of specificTests) {
                try {
                    const response = await fetch(test.url);
                    const text = await response.text();
                    const passed = test.check(text);
                    
                    results.push({
                        name: test.name,
                        status: passed ? 'Ù†Ø¬Ø­' : 'ÙØ´Ù„',
                        details: passed ? 'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©' : 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©'
                    });
                } catch (error) {
                    results.push({
                        name: test.name,
                        status: 'Ø®Ø·Ø£',
                        details: error.message
                    });
                }
            }
            
            let html = '<div class="data-section"><h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©:</h3>';
            
            results.forEach(result => {
                const statusClass = result.status === 'Ù†Ø¬Ø­' ? 'status-success' : 'status-error';
                html += `
                    <div class="test-item">
                        <div class="test-name">
                            ${result.name}
                            <span class="status-badge ${statusClass}">${result.status}</span>
                        </div>
                        <div class="test-details">${result.details}</div>
                    </div>
                `;
            });
            
            html += '</div>';
            showResults(html);
            
            const passedTests = results.filter(r => r.status === 'Ù†Ø¬Ø­');
            updateStatus(`âœ… Ù†Ø¬Ø­ ${passedTests.length} Ù…Ù† Ø£ØµÙ„ ${results.length} Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª`, 
                        passedTests.length === results.length ? 'success' : 'warning');
            
            disableButtons(false);
        }
        
        function simulateHourlyUpdate() {
            updateStatus('ğŸ”„ Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ Ø³Ø§Ø¹Ø©...', 'info');
            
            let html = `
                <div class="data-section">
                    <h3>Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:</h3>
                    <div class="test-item">
                        <div class="test-name">Ø¢Ù„ÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</div>
                        <div class="test-details">
                            âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ÙØ¹Ø¯ Ù„Ù„ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø³Ø§Ø¹Ø©<br>
                            âœ… ÙŠØ¬Ø±Ø¨ Ø¹Ø¯Ø© Ø±ÙˆØ§Ø¨Ø· Ù…Ø®ØªÙ„ÙØ© (CSV, HTML, TSV)<br>
                            âœ… Ù…Ù‡Ù„Ø© Ø²Ù…Ù†ÙŠØ© 30 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ù…Ø­Ø§ÙˆÙ„Ø©<br>
                            âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„<br>
                            âœ… ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡<br><br>
                            
                            <strong>Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø©:</strong><br>
                            - Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ: ÙƒÙ„ 60 Ø¯Ù‚ÙŠÙ‚Ø©<br>
                            - Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©: ÙÙˆØ±ÙŠ<br>
                            - Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠØ¯ÙˆÙŠ: Ù…ØªØ§Ø­ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª<br><br>
                            
                            <strong>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù…Ø­Ø§ÙƒÙŠ:</strong> ${new Date().toLocaleString('ar-SA')}<br>
                            <strong>Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ù„ÙŠ:</strong> ${new Date(Date.now() + 3600000).toLocaleString('ar-SA')}
                        </div>
                    </div>
                </div>
            `;
            
            showResults(html);
            updateStatus('âœ… Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…ÙƒØªÙ…Ù„Ø©', 'success');
        }
        
        function showSystemInfo() {
            const html = `
                <div class="data-section">
                    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:</h3>
                    <div class="test-item">
                        <div class="test-name">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆØ±Ùƒ Ø´ÙŠØª</div>
                        <div class="test-details">
                            <strong>Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰:</strong> Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ† (21 Ù…Ø´ØªØ±Ùƒ)<br>
                            <strong>Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©:</strong> ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª ÙˆØ§Ù„Ù…Ø­ÙØ¸Ø© (8 Ø´Ø±ÙƒØ§Øª)<br>
                            <strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©:</strong> 185,466.35 Ø±.Ø³<br><br>
                            
                            <strong>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</strong><br>
                            - CSV: Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø¸Ù…Ø©<br>
                            - HTML: Ù„Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±Ø¦ÙŠ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„<br>
                            - TSV: ÙƒØ¨Ø¯ÙŠÙ„ Ù„Ù„Ù€ CSV<br><br>
                            
                            <strong>Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:</strong><br>
                            âœ… ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ Ø³Ø§Ø¹Ø©<br>
                            âœ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…ØªÙ‚Ø¯Ù…Ø©<br>
                            âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ø­Ø¯Ø«Ø©<br>
                            âœ… Ø¯Ø¹Ù… Ø¹Ø¯Ø© ØµÙŠØº (CSV, HTML, TSV)<br>
                            âœ… Ù…Ù‡Ù„Ø© Ø²Ù…Ù†ÙŠØ© Ù…Ù†Ø§Ø³Ø¨Ø© (30 Ø«Ø§Ù†ÙŠØ©)<br>
                            âœ… ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ø°ÙƒÙŠ<br><br>
                            
                            <strong>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©:</strong><br>
                            - Ø¬Ø¹ÙØ±: 42 Ø³Ù‡Ù…ØŒ 20.49% Ù…Ù„ÙƒÙŠØ©<br>
                            - Ø¹Ø¨Ø§Ø³: 24 Ø³Ù‡Ù…ØŒ 11.71% Ù…Ù„ÙƒÙŠØ©<br>
                            - Ù…Ø­Ù…Ø¯: 5 Ø£Ø³Ù‡Ù…ØŒ 9.76% Ù…Ù„ÙƒÙŠØ©<br>
                            - Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù‡Ù… Ø§Ù„Ø£Ø³Ø§Ø³: 906.93 Ø±.Ø³<br>
                            - Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù‡Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ: 916.92 Ø±.Ø³
                        </div>
                    </div>
                </div>
            `;
            
            showResults(html);
            updateStatus('â„¹ï¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹Ø±ÙˆØ¶Ø©', 'info');
        }
        
        // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø£ÙˆÙ„ÙŠ
        window.addEventListener('load', () => {
            updateStatus('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± - ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù„Ù„ÙˆØ±Ùƒ Ø´ÙŠØª Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'success');
            console.log('ğŸ‰ Final test system loaded successfully');
            console.log('ğŸ“‹ Updated with new worksheet URLs');
            console.log('â° 30-second timeout for Google Sheets slow loading');
            console.log('ğŸ”„ Auto-update every hour configured');
        });
    </script>
</body>
</html>